{
  "info": {
    "name": "HRMS - Super Admin OTP Flow (Today)",
    "_postman_id": "hrms-superadmin-otp-flow-001",
    "description": "Super Admin Signup -> Login -> Forgot Password -> Verify OTP -> Reset Password. OTP stored in super_admins table.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "1) Super Admin Signup",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json", "type": "text" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"{{superadmin_email}}\",\n  \"password\": \"{{superadmin_password}}\",\n  \"confirm_password\": \"{{superadmin_password}}\",\n  \"first_name\": \"Sai\",\n  \"last_name\": \"Kiran\"\n}",
          "options": { "raw": { "language": "json" } }
        },
        "url": {
          "raw": "{{base_url}}/api/auth/super-admin/signup",
          "host": [ "{{base_url}}" ],
          "path": [ "api", "auth", "super-admin", "signup" ]
        }
      }
    },
    {
      "name": "2) Login (Super Admin) - Save Token",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "var jsonData = pm.response.json();",
              "if (jsonData.token) {",
              "  pm.collectionVariables.set('token', jsonData.token);",
              "}",
              "if (jsonData.base_url) {",
              "  pm.collectionVariables.set('frontend_base_url', jsonData.base_url);",
              "}",
              "console.log('Token:', pm.collectionVariables.get('token'));",
              "console.log('Frontend URL:', pm.collectionVariables.get('frontend_base_url'));"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json", "type": "text" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"{{superadmin_email}}\",\n  \"password\": \"{{superadmin_password}}\"\n}",
          "options": { "raw": { "language": "json" } }
        },
        "url": {
          "raw": "{{base_url}}/api/auth/login",
          "host": [ "{{base_url}}" ],
          "path": [ "api", "auth", "login" ]
        }
      }
    },
    {
      "name": "3) Forgot Password (Send OTP to Email)",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json", "type": "text" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"{{superadmin_email}}\"\n}",
          "options": { "raw": { "language": "json" } }
        },
        "url": {
          "raw": "{{base_url}}/api/auth/forgot-password",
          "host": [ "{{base_url}}" ],
          "path": [ "api", "auth", "forgot-password" ]
        }
      }
    },
    {
      "name": "4) Verify OTP (Paste OTP into variable otp)",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json", "type": "text" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"{{superadmin_email}}\",\n  \"otp\": \"{{otp}}\"\n}",
          "options": { "raw": { "language": "json" } }
        },
        "url": {
          "raw": "{{base_url}}/api/auth/verify-otp",
          "host": [ "{{base_url}}" ],
          "path": [ "api", "auth", "verify-otp" ]
        }
      }
    },
    {
      "name": "5) Reset Password",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json", "type": "text" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"email\": \"{{superadmin_email}}\",\n  \"otp\": \"{{otp}}\",\n  \"password\": \"NewPass@123\",\n  \"confirm_password\": \"NewPass@123\"\n}",
          "options": { "raw": { "language": "json" } }
        },
        "url": {
          "raw": "{{base_url}}/api/auth/reset-password",
          "host": [ "{{base_url}}" ],
          "path": [ "api", "auth", "reset-password" ]
        }
      }
    }
  ],
  "variable": [
    { "key": "base_url", "value": "http://127.0.0.1:5000", "type": "string" },
    { "key": "token", "value": "", "type": "string" },
    { "key": "frontend_base_url", "value": "", "type": "string" },
    { "key": "superadmin_email", "value": "superadmin@hrms.com", "type": "string" },
    { "key": "superadmin_password", "value": "password123", "type": "string" },
    { "key": "otp", "value": "", "type": "string" }
  ]
}
